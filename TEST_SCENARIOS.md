# 🧪 سيناريوهات الاختبار الشاملة

**التاريخ**: 2025-10-09  
**الإصدار**: 1.0  
**الحالة**: جاهز للتنفيذ

---

## 📋 قائمة الاختبارات

### ✅ المجموعة 1: اختبار الفواتير والمديونية

#### 🧪 اختبار 1.1: فاتورة بيع عادية

**الهدف**: التحقق من أن فاتورة البيع العادية تزيد المديونية بدون التأثير على الحسابات

**الخطوات**:
1. افتح صفحة العملاء: `http://localhost:3002/customers`
2. اختر عميل موجود (أو أنشئ عميل جديد)
3. سجل المديونية الحالية (مثلاً: 0 جنيه)
4. انقر "فاتورة جديدة"
5. اختر "فاتورة بيع عادية"
6. املأ البيانات:
   - رقم الفاتورة: `INV-001`
   - التاريخ: اليوم
   - المبلغ: `5000` جنيه
   - الوصف: `بيع بضاعة`
7. انقر "إنشاء الفاتورة"

**النتائج المتوقعة**:
- ✅ المديونية الجديدة = 0 + 5000 = **5000 جنيه**
- ✅ حالة الفاتورة = **غير مدفوعة** (unpaid)
- ✅ المبلغ المدفوع = **0 جنيه**
- ✅ المبلغ المتبقي = **5000 جنيه**
- ✅ ظهور الفاتورة في قائمة الفواتير
- ✅ ظهور معاملة جديدة في سجل المعاملات
- ✅ ظهور نشاط جديد في سجل الأنشطة
- ✅ **لا يتأثر أي حساب مالي**

---

#### 🧪 اختبار 1.2: دفعة من العميل → حساب بنكي (تحصيل فوري)

**الهدف**: التحقق من أن الدفعة من العميل تقلل المديونية وتزيد رصيد الحساب البنكي

**المتطلبات المسبقة**:
- عميل له مديونية 5000 جنيه (من الاختبار السابق)
- حساب بنكي برصيد 10000 جنيه

**الخطوات**:
1. افتح صفحة العميل
2. سجل المديونية الحالية: **5000 جنيه**
3. افتح صفحة الحسابات البنكية وسجل الرصيد: **10000 جنيه**
4. ارجع لصفحة العميل وانقر "فاتورة جديدة"
5. اختر "فاتورة تحويل"
6. املأ البيانات:
   - رقم الفاتورة: `INV-002`
   - التاريخ: اليوم
   - المبلغ: `2000` جنيه
   - الوصف: `دفعة نقدية`
7. في قسم "من الحساب (المصدر)":
   - نوع الحساب: **العميل (دفعة من العميل)** (افتراضياً)
   - الحساب: سيكون العميل الحالي تلقائياً
8. في قسم "إلى الحساب (الوجهة)":
   - نوع الحساب: **حساب بنكي**
   - الحساب: اختر الحساب البنكي
9. في قسم "الرسوم والتحصيل":
   - الرسوم: `0` جنيه
   - من يتحمل الرسوم: **لا أحد**
   - نوع التحصيل: **فوري**
10. راجع ملخص المبالغ:
    - المبلغ المخصوم: 2000 جنيه
    - الرسوم: 0 جنيه
    - المبلغ المحصل: 2000 جنيه
11. انقر "إنشاء الفاتورة"

**النتائج المتوقعة**:
- ✅ المديونية الجديدة = 5000 - 2000 = **3000 جنيه**
- ✅ رصيد الحساب البنكي = 10000 + 2000 = **12000 جنيه**
- ✅ حالة الفاتورة = **مدفوعة** (paid)
- ✅ المبلغ المدفوع = **2000 جنيه**
- ✅ المبلغ المتبقي = **0 جنيه**
- ✅ ظهور الفاتورة في قائمة الفواتير
- ✅ ظهور معاملة جديدة في سجل المعاملات
- ✅ ظهور نشاط جديد في سجل الأنشطة

---

#### 🧪 اختبار 1.3: تحويل من حساب بنكي → العميل (تحصيل آجل)

**الهدف**: التحقق من أن التحويل للعميل يزيد المديونية ويقلل رصيد الحساب البنكي

**المتطلبات المسبقة**:
- عميل له مديونية 3000 جنيه (من الاختبار السابق)
- حساب بنكي برصيد 12000 جنيه (من الاختبار السابق)

**الخطوات**:
1. افتح صفحة العميل
2. سجل المديونية الحالية: **3000 جنيه**
3. افتح صفحة الحسابات البنكية وسجل الرصيد: **12000 جنيه**
4. ارجع لصفحة العميل وانقر "فاتورة جديدة"
5. اختر "فاتورة تحويل"
6. املأ البيانات:
   - رقم الفاتورة: `INV-003`
   - التاريخ: اليوم
   - المبلغ: `1500` جنيه
   - الوصف: `سلفة للعميل`
7. في قسم "من الحساب (المصدر)":
   - نوع الحساب: **حساب بنكي**
   - الحساب: اختر الحساب البنكي
8. في قسم "إلى الحساب (الوجهة)":
   - نوع الحساب: **العميل (تحويل للعميل)**
   - الحساب: سيكون العميل الحالي تلقائياً
9. في قسم "الرسوم والتحصيل":
   - الرسوم: `50` جنيه
   - من يتحمل الرسوم: **المرسل** (الحساب البنكي)
   - نوع التحصيل: **آجل**
10. راجع ملخص المبالغ:
    - المبلغ المخصوم: 1500 + 50 = 1550 جنيه
    - الرسوم: 50 جنيه
    - المبلغ المحصل: 1500 جنيه
11. انقر "إنشاء الفاتورة"

**النتائج المتوقعة**:
- ✅ المديونية الجديدة = 3000 + 1500 = **4500 جنيه**
- ✅ رصيد الحساب البنكي = 12000 - 1550 = **10450 جنيه**
- ✅ حالة الفاتورة = **غير مدفوعة** (unpaid)
- ✅ المبلغ المدفوع = **0 جنيه**
- ✅ المبلغ المتبقي = **1500 جنيه**
- ✅ ظهور الفاتورة في قائمة الفواتير
- ✅ ظهور معاملة جديدة في سجل المعاملات
- ✅ ظهور نشاط جديد في سجل الأنشطة

---

### ✅ المجموعة 2: اختبار الرسوم

#### 🧪 اختبار 2.1: رسوم يتحملها المرسل

**الهدف**: التحقق من أن الرسوم تُخصم من المرسل

**الخطوات**:
1. افتح صفحة العميل
2. سجل رصيد الحساب البنكي: **10450 جنيه**
3. انقر "فاتورة جديدة" → "فاتورة تحويل"
4. املأ البيانات:
   - المبلغ: `1000` جنيه
   - من الحساب: **حساب بنكي**
   - إلى الحساب: **محفظة إلكترونية**
   - الرسوم: `100` جنيه
   - من يتحمل الرسوم: **المرسل**
   - نوع التحصيل: **فوري**
5. راجع الملخص:
   - المبلغ المخصوم: 1000 + 100 = **1100 جنيه**
   - المبلغ المحصل: **1000 جنيه**
6. انقر "إنشاء الفاتورة"

**النتائج المتوقعة**:
- ✅ رصيد الحساب البنكي = 10450 - 1100 = **9350 جنيه**
- ✅ رصيد المحفظة الإلكترونية = الرصيد السابق + 1000 جنيه

---

#### 🧪 اختبار 2.2: رسوم يتحملها المستقبل

**الهدف**: التحقق من أن الرسوم تُخصم من المستقبل

**الخطوات**:
1. افتح صفحة العميل
2. سجل رصيد الحساب البنكي: **9350 جنيه**
3. سجل رصيد المحفظة الإلكترونية
4. انقر "فاتورة جديدة" → "فاتورة تحويل"
5. املأ البيانات:
   - المبلغ: `1000` جنيه
   - من الحساب: **حساب بنكي**
   - إلى الحساب: **محفظة إلكترونية**
   - الرسوم: `100` جنيه
   - من يتحمل الرسوم: **المستقبل**
   - نوع التحصيل: **فوري**
6. راجع الملخص:
   - المبلغ المخصوم: **1000 جنيه**
   - المبلغ المحصل: 1000 - 100 = **900 جنيه**
7. انقر "إنشاء الفاتورة"

**النتائج المتوقعة**:
- ✅ رصيد الحساب البنكي = 9350 - 1000 = **8350 جنيه**
- ✅ رصيد المحفظة الإلكترونية = الرصيد السابق + 900 جنيه

---

### ✅ المجموعة 3: اختبار التحصيل الآجل

#### 🧪 اختبار 3.1: تحصيل آجل (لا يؤثر على الحسابات فوراً)

**الهدف**: التحقق من أن التحصيل الآجل لا يؤثر على حساب الوجهة

**الخطوات**:
1. افتح صفحة العميل
2. سجل المديونية الحالية
3. سجل رصيد الحساب البنكي
4. انقر "فاتورة جديدة" → "فاتورة تحويل"
5. املأ البيانات:
   - المبلغ: `500` جنيه
   - من الحساب: **العميل**
   - إلى الحساب: **حساب بنكي**
   - الرسوم: `0` جنيه
   - نوع التحصيل: **آجل**
6. انقر "إنشاء الفاتورة"

**النتائج المتوقعة**:
- ✅ المديونية = الرصيد السابق + 500 جنيه
- ✅ رصيد الحساب البنكي = **بدون تغيير** (لأن التحصيل آجل)
- ✅ حالة الفاتورة = **غير مدفوعة** (unpaid)

---

### ✅ المجموعة 4: اختبار السيناريوهات المعقدة

#### 🧪 اختبار 4.1: سلسلة تحويلات متعددة

**الهدف**: التحقق من صحة الحسابات بعد عدة تحويلات

**الخطوات**:
1. سجل الأرصدة الأولية:
   - مديونية العميل: X
   - حساب بنكي: Y
   - محفظة إلكترونية: Z
2. نفذ التحويلات التالية:
   - دفعة من العميل → حساب بنكي (1000 جنيه)
   - تحويل من حساب بنكي → محفظة إلكترونية (500 جنيه)
   - تحويل من محفظة إلكترونية → العميل (300 جنيه)
3. احسب الأرصدة المتوقعة يدوياً
4. قارن مع الأرصدة الفعلية في النظام

**النتائج المتوقعة**:
- ✅ جميع الأرصدة صحيحة
- ✅ المديونية محسوبة بشكل صحيح
- ✅ جميع المعاملات مسجلة

---

#### 🧪 اختبار 4.2: دفعة جزئية

**الهدف**: التحقق من أن الدفعة الجزئية تحدث حالة الفاتورة بشكل صحيح

**الخطوات**:
1. أنشئ فاتورة بيع عادية بمبلغ 5000 جنيه
2. سجل دفعة من العميل بمبلغ 2000 جنيه (تحصيل فوري)
3. تحقق من حالة الفاتورة

**النتائج المتوقعة**:
- ✅ حالة الفاتورة = **مدفوعة جزئياً** (partial)
- ✅ المبلغ المدفوع = **2000 جنيه**
- ✅ المبلغ المتبقي = **3000 جنيه**
- ✅ المديونية = المديونية السابقة + 5000 - 2000

---

### ✅ المجموعة 5: اختبار الأخطاء والتحقق

#### 🧪 اختبار 5.1: منع التحويل من وإلى نفس الحساب

**الهدف**: التحقق من أن النظام يمنع التحويل من حساب إلى نفسه

**الخطوات**:
1. افتح نافذة "فاتورة جديدة" → "فاتورة تحويل"
2. اختر نفس الحساب البنكي كمصدر ووجهة
3. حاول إنشاء الفاتورة

**النتائج المتوقعة**:
- ✅ ظهور رسالة خطأ: "لا يمكن التحويل من وإلى نفس الحساب"
- ✅ عدم إنشاء الفاتورة

---

#### 🧪 اختبار 5.2: منع إنشاء فاتورة بمبلغ صفر أو سالب

**الهدف**: التحقق من التحقق من صحة البيانات

**الخطوات**:
1. افتح نافذة "فاتورة جديدة"
2. أدخل مبلغ `0` أو `-100`
3. حاول إنشاء الفاتورة

**النتائج المتوقعة**:
- ✅ ظهور رسالة خطأ: "المبلغ يجب أن يكون أكبر من صفر"
- ✅ عدم إنشاء الفاتورة

---

#### 🧪 اختبار 5.3: منع إنشاء فاتورة بدون بيانات مطلوبة

**الهدف**: التحقق من التحقق من الحقول المطلوبة

**الخطوات**:
1. افتح نافذة "فاتورة جديدة" → "فاتورة تحويل"
2. اترك حقل "الحساب" فارغاً
3. حاول إنشاء الفاتورة

**النتائج المتوقعة**:
- ✅ ظهور رسالة خطأ: "يرجى ملء جميع الحقول المطلوبة"
- ✅ عدم إنشاء الفاتورة

---

## 📝 نموذج تسجيل نتائج الاختبار

| # | اسم الاختبار | الحالة | الملاحظات |
|---|--------------|--------|-----------|
| 1.1 | فاتورة بيع عادية | ⬜ لم يُختبر | |
| 1.2 | دفعة من العميل → حساب بنكي | ⬜ لم يُختبر | |
| 1.3 | تحويل من حساب بنكي → العميل | ⬜ لم يُختبر | |
| 2.1 | رسوم يتحملها المرسل | ⬜ لم يُختبر | |
| 2.2 | رسوم يتحملها المستقبل | ⬜ لم يُختبر | |
| 3.1 | تحصيل آجل | ⬜ لم يُختبر | |
| 4.1 | سلسلة تحويلات متعددة | ⬜ لم يُختبر | |
| 4.2 | دفعة جزئية | ⬜ لم يُختبر | |
| 5.1 | منع التحويل لنفس الحساب | ⬜ لم يُختبر | |
| 5.2 | منع مبلغ صفر أو سالب | ⬜ لم يُختبر | |
| 5.3 | منع بيانات ناقصة | ⬜ لم يُختبر | |

**رموز الحالة**:
- ⬜ لم يُختبر
- ✅ نجح
- ❌ فشل
- ⚠️ نجح مع ملاحظات

---

## 🎯 الخلاصة

بعد إكمال جميع الاختبارات، يجب أن تكون النتيجة:
- ✅ جميع الفواتير تؤثر على المديونية بشكل صحيح
- ✅ جميع التحويلات تؤثر على الأرصدة بشكل صحيح
- ✅ الرسوم محسوبة بشكل صحيح
- ✅ التحصيل الفوري/الآجل يعمل بشكل صحيح
- ✅ التحقق من البيانات يعمل بشكل صحيح

---

**تم إنشاء الملف بواسطة**: Augment Agent  
**التاريخ**: 2025-10-09

