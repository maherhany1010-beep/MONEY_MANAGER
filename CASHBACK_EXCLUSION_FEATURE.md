# ๐ซ ููุฒุฉ ุงุณุชุซูุงุก ุงููุนุงููุงุช ูู ุงููุงุด ุจุงู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ููุฒุฉ ุฌุฏูุฏุฉ ุชุชูุญ ูููุณุชุฎุฏู **ุงุณุชุซูุงุก ูุนุงููุงุช ุดุฑุงุก ูุนููุฉ ูู ุงููุงุด ุจุงู** ุฃุซูุงุก ุนูููุฉ ุงูุดุฑุงุก.

ูุฐู ุงูููุฒุฉ ูููุฏุฉ ูู ุงูุญุงูุงุช ุงูุชุงููุฉ:
- ๐ณ ูุนุงููุงุช ูุง ุชุณุชุญู ูุงุด ุจุงู (ุญุณุจ ุณูุงุณุฉ ุงูุจูู)
- ๐ฆ ูุนุงููุงุช ุญููููุฉ ุฃู ุฑุณูู
- ๐ฐ ุณุญุจ ููุฏู ุฃู ุชุญูููุงุช
- ๐ฐ ูุนุงููุงุช ูู ูุฆุงุช ูุณุชุซูุงุฉ (ูุซู ุงูููุงุฑุ ุงูุนููุงุช ุงูุฑูููุฉ)
- ๐ ุฃู ูุนุงููุฉ ูุฑุบุจ ุงููุณุชุฎุฏู ูู ุงุณุชุซูุงุฆูุง ูุฏููุงู

---

## ๐ฏ ุงูููุฒุงุช ุงููููุฐุฉ

### โ 1. ุฎูุงุฑ ุงูุงุณุชุซูุงุก ูู ูููุฐุฌ ุงูุดุฑุงุก
- โ ููุชุงุญ ุชุจุฏูู (Switch) ูุชูุนูู/ุชุนุทูู ุงูุงุณุชุซูุงุก
- โ ุชุตููู ูููุฒ ุจููู ููุฑูุงูู (Amber) ูููุช ุงูุงูุชุจุงู
- โ ูุต ุชูุถูุญู: "ูู ูุชู ุงุญุชุณุงุจ ูุงุด ุจุงู ุนูู ูุฐู ุงููุนุงููุฉ"
- โ ุฏุนู ุงููุถุน ุงููููู (Dark Mode)

### โ 2. ุญุณุงุจ ุงููุงุด ุจุงู ุงูุฏููุงูููู
- โ ุนูุฏ ุชูุนูู ุงูุงุณุชุซูุงุก: ุงููุงุด ุจุงู = 0
- โ ุนูุฏ ุชุนุทูู ุงูุงุณุชุซูุงุก: ุงููุงุด ุจุงู = ุงููุจูุบ ร ูุณุจุฉ ุงููุงุด ุจุงู

### โ 3. ููุฎุต ุงูุนูููุฉ ุงููุญุฏุซ
- โ ุฅุฎูุงุก ุณุทุฑ ุงููุงุด ุจุงู ุนูุฏ ุงูุงุณุชุซูุงุก
- โ ุนุฑุถ ุฑุณุงูุฉ ุชูุจูู: "ุชู ุงุณุชุซูุงุก ูุฐู ุงููุนุงููุฉ ูู ุงููุงุด ุจุงู"
- โ ุชุตููู ุงูุฑุณุงูุฉ ุจููู ููุฑูุงูู ูุน ุฃููููุฉ ุชูุจูู

### โ 4. ุญูุธ ูุนูููุฉ ุงูุงุณุชุซูุงุก
- โ ุฅุถุงูุฉ ุญูู `excludedFromCashback` ูู ุจูุงูุงุช ุงููุนุงููุฉ
- โ ูููู ุงุณุชุฎุฏุงูู ูุงุญูุงู ูู ุงูุชูุงุฑูุฑ ูุงูุฅุญุตุงุฆูุงุช

---

## ๐๏ธ ุงูุชูุงุตูู ุงูุชูููุฉ

### 1. ุงูุชุนุฏููุงุช ุนูู ุงูููุฏ

**ุงูููู**: `src/components/cards/add-purchase-dialog.tsx`

#### ุฃ. ุฅุถุงูุฉ State ููุงุณุชุซูุงุก:
```typescript
const [excludeFromCashback, setExcludeFromCashback] = useState(false)
```

#### ุจ. ุชุนุฏูู ุญุณุงุจ ุงููุงุด ุจุงู:
```typescript
// ูุจู ุงูุชุนุฏูู:
const cashback = amount * (card.cashbackRate || 0) / 100

// ุจุนุฏ ุงูุชุนุฏูู:
const cashback = excludeFromCashback ? 0 : (amount * (card.cashbackRate || 0) / 100)
```

#### ุฌ. ุฅุถุงูุฉ ุงูุญูู ูู ุจูุงูุงุช ุงููุนุงููุฉ:
```typescript
const purchase = {
  id: Date.now().toString(),
  type: 'withdrawal',
  amount: totalAmount,
  baseAmount: amount,
  purchaseFee: purchaseFee,
  cashback: cashback,
  excludedFromCashback: excludeFromCashback, // โ ุฌุฏูุฏ
  description: formData.description,
  merchant: formData.merchantName || formData.merchantId,
  category: formData.category,
  transactionDate: new Date(formData.date).toISOString(),
  cardId: card.id,
}
```

#### ุฏ. ุฅุนุงุฏุฉ ุชุนููู ุงููููุฉ ุนูุฏ ุฅุบูุงู ุงููููุฐุฌ:
```typescript
setExcludeFromCashback(false)
```

---

### 2. ูุงุฌูุฉ ุงููุณุชุฎุฏู

#### ุฃ. ููุชุงุญ ุงูุชุจุฏูู (Switch):
```tsx
<div className="flex items-center justify-between p-3 bg-amber-50 dark:bg-amber-950/30 rounded-lg border border-amber-200 dark:border-amber-700">
  <div className="flex-1">
    <div className="flex items-center gap-2">
      <Label htmlFor="exclude-cashback" className="cursor-pointer font-medium dark:text-amber-100" style={{ color: '#d97706' }}>
        ุงุณุชุซูุงุก ูู ุงููุงุด ุจุงู
      </Label>
    </div>
    <p className="text-xs text-gray-600 dark:text-gray-400 mt-1">
      ูู ูุชู ุงุญุชุณุงุจ ูุงุด ุจุงู ุนูู ูุฐู ุงููุนุงููุฉ
    </p>
  </div>
  <Switch
    id="exclude-cashback"
    checked={excludeFromCashback}
    onCheckedChange={setExcludeFromCashback}
  />
</div>
```

#### ุจ. ุฑุณุงูุฉ ุงูุชูุจูู ูู ุงูููุฎุต:
```tsx
{excludeFromCashback && (
  <div className="flex items-center gap-2 p-2 bg-amber-100 dark:bg-amber-900/30 border border-amber-300 dark:border-amber-600 rounded text-xs dark:text-amber-200" style={{ color: '#d97706' }}>
    <AlertCircle className="h-4 w-4" />
    <span>ุชู ุงุณุชุซูุงุก ูุฐู ุงููุนุงููุฉ ูู ุงููุงุด ุจุงู</span>
  </div>
)}
```

---

## ๐จ ุงูุชุตููู

### ุงูุฃููุงู ุงููุณุชุฎุฏูุฉ:

| ุงูุนูุตุฑ | Light Mode | Dark Mode |
|--------|-----------|-----------|
| **ุงูุฎูููุฉ** | `bg-amber-50` | `bg-amber-950/30` |
| **ุงูุญุฏูุฏ** | `border-amber-200` | `border-amber-700` |
| **ุงููุต** | `#d97706` (Amber-600) | `text-amber-100` |
| **ุฑุณุงูุฉ ุงูุชูุจูู** | `bg-amber-100` | `bg-amber-900/30` |

### ุงูุฃููููุงุช:
- โ๏ธ `AlertCircle`: ุฃููููุฉ ุงูุชูุจูู ูู ุฑุณุงูุฉ ุงูุงุณุชุซูุงุก

---

## ๐ ุณูุฑ ุงูุนูู (Workflow)

### ุงูุณููุงุฑูู 1: ุดุฑุงุก ุนุงุฏู (ุจุฏูู ุงุณุชุซูุงุก)

```
ุงููุณุชุฎุฏู โ ููุชุญ ูููุฐุฌ ุงูุดุฑุงุก
         โ
    ูููุฃ ุงูุจูุงูุงุช:
    - ุงููุจูุบ: 1000 ุฌููู
    - ุงูููุงู: ูุงุฑููุฑ
    - ุงููุฆุฉ: ุทุนุงู ููุดุฑูุจุงุช
         โ
    ููุชุงุญ ุงูุงุณุชุซูุงุก: โ ูุนุทู (ุงูุชุฑุงุถู)
         โ
    ุงููุงุด ุจุงู ุงููุญุณูุจ:
    1000 ร 2.5% = 25 ุฌููู โ
         โ
    ููุฎุต ุงูุนูููุฉ:
    - ูุจูุบ ุงูุดุฑุงุก: 1000 ุฌููู
    - ูุงุด ุจุงู: -25 ุฌููู
    - ุตุงูู ุงูุชูููุฉ: 975 ุฌููู
         โ
    ุญูุธ ุงููุนุงููุฉ:
    - cashback: 25
    - excludedFromCashback: false
```

---

### ุงูุณููุงุฑูู 2: ุดุฑุงุก ูุณุชุซูู ูู ุงููุงุด ุจุงู

```
ุงููุณุชุฎุฏู โ ููุชุญ ูููุฐุฌ ุงูุดุฑุงุก
         โ
    ูููุฃ ุงูุจูุงูุงุช:
    - ุงููุจูุบ: 500 ุฌููู
    - ุงูููุงู: ูุตูุญุฉ ุงูุถุฑุงุฆุจ
    - ุงููุฆุฉ: ููุงุชูุฑ
         โ
    ููุชุงุญ ุงูุงุณุชุซูุงุก: โ ููุนูู
         โ
    ุงููุงุด ุจุงู ุงููุญุณูุจ:
    0 ุฌููู (ูุณุชุซูู) โ
         โ
    ููุฎุต ุงูุนูููุฉ:
    - ูุจูุบ ุงูุดุฑุงุก: 500 ุฌููู
    - โ๏ธ ุชู ุงุณุชุซูุงุก ูุฐู ุงููุนุงููุฉ ูู ุงููุงุด ุจุงู
    - (ูุง ูุธูุฑ ุณุทุฑ ุงููุงุด ุจุงู)
    - (ูุง ูุธูุฑ ุตุงูู ุงูุชูููุฉ)
         โ
    ุญูุธ ุงููุนุงููุฉ:
    - cashback: 0
    - excludedFromCashback: true
```

---

## ๐งช ุงุฎุชุจุงุฑ ุงูููุฒุฉ

### ุงุฎุชุจุงุฑ 1: ุดุฑุงุก ุนุงุฏู (3 ุฏูุงุฆู)

**ุงูุฎุทูุงุช**:
1. โ ุงูุชุญ ุตูุญุฉ ุงูุจุทุงูุฉ: `http://localhost:3003/cards/1`
2. โ ุงููุฑ ุฒุฑ **"ุดุฑุงุก"** ๐
3. โ ุงููุฃ ุงูุจูุงูุงุช:
   - ุงููุจูุบ: `1000`
   - ุงููุตู: `ุชุณูู ูู ูุงุฑููุฑ`
   - ุงูููุงู: ุงุฎุชุฑ ูู ุงููุงุฆูุฉ
   - ุงููุฆุฉ: `ุทุนุงู ููุดุฑูุจุงุช`
4. โ **ูุง ุชูุนูู** ููุชุงุญ "ุงุณุชุซูุงุก ูู ุงููุงุด ุจุงู"
5. โ ุชุญูู ูู ููุฎุต ุงูุนูููุฉ:
   - ูุจูุบ ุงูุดุฑุงุก: `1,000.00 ุฌููู`
   - ูุงุด ุจุงู (2.5%): `-25.00 ุฌููู` โ
   - ุตุงูู ุงูุชูููุฉ: `975.00 ุฌููู` โ
6. โ ุงููุฑ **"ุฅุถุงูุฉ ุนูููุฉ ุงูุดุฑุงุก"**

**ุงููุชูุฌุฉ ุงููุชููุนุฉ**:
- โ ุงููุนุงููุฉ ุชูุถุงู ุจูุฌุงุญ
- โ ุงููุงุด ุจุงู = 25 ุฌููู
- โ `excludedFromCashback = false`

---

### ุงุฎุชุจุงุฑ 2: ุดุฑุงุก ูุณุชุซูู ูู ุงููุงุด ุจุงู (4 ุฏูุงุฆู)

**ุงูุฎุทูุงุช**:
1. โ ุงูุชุญ ุตูุญุฉ ุงูุจุทุงูุฉ: `http://localhost:3003/cards/1`
2. โ ุงููุฑ ุฒุฑ **"ุดุฑุงุก"** ๐
3. โ ุงููุฃ ุงูุจูุงูุงุช:
   - ุงููุจูุบ: `500`
   - ุงููุตู: `ุฏูุน ุฑุณูู ุญููููุฉ`
   - ุงูููุงู: (ุฅุฏุฎุงู ูุฏูู) `ูุตูุญุฉ ุงูุถุฑุงุฆุจ`
   - ุงููุฆุฉ: `ููุงุชูุฑ`
4. โ **ูุนูู** ููุชุงุญ "ุงุณุชุซูุงุก ูู ุงููุงุด ุจุงู" โ
5. โ ุชุญูู ูู ููุฎุต ุงูุนูููุฉ:
   - ูุจูุบ ุงูุดุฑุงุก: `500.00 ุฌููู`
   - โ๏ธ ุฑุณุงูุฉ: "ุชู ุงุณุชุซูุงุก ูุฐู ุงููุนุงููุฉ ูู ุงููุงุด ุจุงู" โ
   - **ูุง ูุธูุฑ** ุณุทุฑ ุงููุงุด ุจุงู โ
   - **ูุง ูุธูุฑ** ุตุงูู ุงูุชูููุฉ โ
6. โ ุงููุฑ **"ุฅุถุงูุฉ ุนูููุฉ ุงูุดุฑุงุก"**

**ุงููุชูุฌุฉ ุงููุชููุนุฉ**:
- โ ุงููุนุงููุฉ ุชูุถุงู ุจูุฌุงุญ
- โ ุงููุงุด ุจุงู = 0 ุฌููู
- โ `excludedFromCashback = true`

---

### ุงุฎุชุจุงุฑ 3: ุงูุชุจุฏูู ุจูู ุงูุญุงูุชูู (3 ุฏูุงุฆู)

**ุงูุฎุทูุงุช**:
1. โ ุงูุชุญ ูููุฐุฌ ุงูุดุฑุงุก
2. โ ุงููุฃ ุงููุจูุบ: `1000`
3. โ ุชุญูู ูู ุงููุงุด ุจุงู: `25 ุฌููู` โ
4. โ **ูุนูู** ููุชุงุญ ุงูุงุณุชุซูุงุก
5. โ ุชุญูู ูู ุงุฎุชูุงุก ุงููุงุด ุจุงู ูุธููุฑ ุงูุฑุณุงูุฉ โ
6. โ **ุนุทูู** ููุชุงุญ ุงูุงุณุชุซูุงุก
7. โ ุชุญูู ูู ุนูุฏุฉ ุงููุงุด ุจุงู: `25 ุฌููู` โ

**ุงููุชูุฌุฉ ุงููุชููุนุฉ**:
- โ ุงูุชุจุฏูู ูุนูู ุจุดูู ููุฑู
- โ ุงูุญุณุงุจุงุช ุชุชุญุฏุซ ุฏููุงููููุงู
- โ ุงูุฑุณุงุฆู ุชุธูุฑ/ุชุฎุชูู ุญุณุจ ุงูุญุงูุฉ

---

## ๐ ุงูุงุณุชุฎุฏุงูุงุช ุงููุณุชูุจููุฉ

### 1. ุงูุชูุงุฑูุฑ ูุงูุฅุญุตุงุฆูุงุช:
```typescript
// ุญุณุงุจ ุฅุฌูุงูู ุงููุงุด ุจุงู ุงููุนูู
const totalCashback = transactions
  .filter(t => !t.excludedFromCashback)
  .reduce((sum, t) => sum + t.cashback, 0)

// ุญุณุงุจ ุนุฏุฏ ุงููุนุงููุงุช ุงููุณุชุซูุงุฉ
const excludedCount = transactions
  .filter(t => t.excludedFromCashback)
  .length
```

### 2. ุงูููุงุชุฑ:
```typescript
// ุนุฑุถ ุงููุนุงููุงุช ุงููุณุชุซูุงุฉ ููุท
const excludedTransactions = transactions
  .filter(t => t.excludedFromCashback)

// ุนุฑุถ ุงููุนุงููุงุช ุงูุชู ุญุตูุช ุนูู ูุงุด ุจุงู
const cashbackTransactions = transactions
  .filter(t => !t.excludedFromCashback && t.cashback > 0)
```

### 3. ุงูุชูุจููุงุช:
```typescript
// ุชูุจูู ุฅุฐุง ูุงูุช ูุณุจุฉ ุงููุนุงููุงุช ุงููุณุชุซูุงุฉ ุนุงููุฉ
const excludedPercentage = (excludedCount / transactions.length) * 100
if (excludedPercentage > 30) {
  alert('โ๏ธ ุฃูุซุฑ ูู 30% ูู ูุนุงููุงุชู ูุณุชุซูุงุฉ ูู ุงููุงุด ุจุงู')
}
```

---

## ๐ฏ ุงูููุงุฆุฏ

### ูููุณุชุฎุฏู:
- โ **ุฏูุฉ ุฃุนูู**: ุญุณุงุจ ูุงุด ุจุงู ุฏููู ูุนูุณ ุงููุงูุน
- โ **ูุฑููุฉ**: ุงูุชุญูู ูู ุงููุนุงููุงุช ุงูุชู ุชุณุชุญู ูุงุด ุจุงู
- โ **ุดูุงููุฉ**: ูุนุฑูุฉ ุฃู ูุนุงููุงุช ูุง ุชุญุตู ุนูู ูุงุด ุจุงู
- โ **ุณูููุฉ**: ุฎูุงุฑ ุจุณูุท ููุงุถุญ ูู ูููุฐุฌ ุงูุดุฑุงุก

### ูููุธุงู:
- โ **ุจูุงูุงุช ุฏูููุฉ**: ุชุชุจุน ุงููุนุงููุงุช ุงููุณุชุซูุงุฉ
- โ **ุชูุงุฑูุฑ ุฃูุถู**: ุฅุญุตุงุฆูุงุช ุฃูุซุฑ ุฏูุฉ
- โ **ุชูุงูู**: ูุชูุงุดู ูุน ุณูุงุณุงุช ุงูุจููู ุงููุนููุฉ
- โ **ูุงุจููุฉ ุงูุชูุณุน**: ูููู ุฅุถุงูุฉ ููุงุนุฏ ุชููุงุฆูุฉ ูุงุญูุงู

---

## ๐ฎ ุงูุชุทููุฑุงุช ุงููุณุชูุจููุฉ ุงูููุชุฑุญุฉ

### 1. ุงูุงุณุชุซูุงุก ุงูุชููุงุฆู ุญุณุจ ุงููุฆุฉ:
```typescript
// ุฅุนุฏุงุฏุงุช ุงูุจุทุงูุฉ
const excludedCategories = ['ููุงุชูุฑ', 'ุฑุณูู ุญููููุฉ', 'ุณุญุจ ููุฏู']

// ุงุณุชุซูุงุก ุชููุงุฆู
if (excludedCategories.includes(formData.category)) {
  setExcludeFromCashback(true)
}
```

### 2. ุงูุงุณุชุซูุงุก ุงูุชููุงุฆู ุญุณุจ ุงูููุงู:
```typescript
// ูุงุฆูุฉ ุงูุฃูุงูู ุงููุณุชุซูุงุฉ
const excludedMerchants = ['ูุตูุญุฉ ุงูุถุฑุงุฆุจ', 'ุงูุจูู ุงููุฑูุฒู']

// ุงุณุชุซูุงุก ุชููุงุฆู
if (excludedMerchants.includes(formData.merchantName)) {
  setExcludeFromCashback(true)
}
```

### 3. ุชูุฑูุฑ ุงููุนุงููุงุช ุงููุณุชุซูุงุฉ:
- ๐ ุนุฏุฏ ุงููุนุงููุงุช ุงููุณุชุซูุงุฉ
- ๐ฐ ุฅุฌูุงูู ุงููุจุงูุบ ุงููุณุชุซูุงุฉ
- ๐ ูุณุจุฉ ุงูุงุณุชุซูุงุก ูู ุฅุฌูุงูู ุงููุนุงููุงุช
- ๐ ุชูุฒูุน ุงููุนุงููุงุช ุงููุณุชุซูุงุฉ ุญุณุจ ุงูุดูุฑ

### 4. Badge ูู ูุงุฆูุฉ ุงููุนุงููุงุช:
```tsx
{transaction.excludedFromCashback && (
  <Badge variant="secondary" className="bg-amber-100 text-amber-800">
    ูุณุชุซูู ูู ุงููุงุด ุจุงู
  </Badge>
)}
```

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

| ุงูููู | ุงูุชุนุฏููุงุช | ุงูุฃุณุทุฑ |
|-------|-----------|--------|
| `src/components/cards/add-purchase-dialog.tsx` | ุฅุถุงูุฉ ููุฒุฉ ุงูุงุณุชุซูุงุก | ~30 ุณุทุฑ |

---

## โ ุงูุฎูุงุตุฉ

ุชู ุฅุถุงูุฉ ููุฒุฉ **ุงุณุชุซูุงุก ุงููุนุงููุงุช ูู ุงููุงุด ุจุงู** ุจูุฌุงุญ! ๐

**ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ**:
- โ ููุชุงุญ ุชุจุฏูู ุจุณูุท ููุงุถุญ
- โ ุญุณุงุจ ุฏููุงูููู ูููุงุด ุจุงู
- โ ุฑุณุงุฆู ุชูุจูู ูุงุถุญุฉ
- โ ุฏุนู ูุงูู ูููุถุน ุงููููู
- โ ุญูุธ ูุนูููุฉ ุงูุงุณุชุซูุงุก ูู ุจูุงูุงุช ุงููุนุงููุฉ

**ุฌุงูุฒ ููุงุฎุชุจุงุฑ**: `http://localhost:3003/cards/1` โ ุฒุฑ "ุดุฑุงุก" ๐

---

**ุชู ุงูุชุทููุฑ ุจูุงุณุทุฉ**: Augment Agent  
**ุงูุชุงุฑูุฎ**: 2025-10-09  
**ุงูุฅุตุฏุงุฑ**: 1.0.0

