# ๐ ุชุญุณููุงุช ูุธุงู ุงููุจูุนุงุช - ุชูุฑูุฑ ุดุงูู

**ุงูุชุงุฑูุฎ:** 2025-10-24  
**ุงูุญุงูุฉ:** โ ููุชูู  
**ุงูุฅุตุฏุงุฑ:** 1.0

---

## ๐ฏ ููุฎุต ุงูุชุญุณููุงุช

ุชู ุฅุตูุงุญ ูุชุญุณูู ูุธุงู ุงููุจูุนุงุช ุจุดูู ุดุงูู ูุฏุนู ุทุฑู ุฏูุน ูุชุนุฏุฏุฉ ูุน ุชุญุฏูุซ ุงูุฃุฑุตุฏุฉ ุชููุงุฆูุงู:

### โ ุงููุดุงูู ุงูุชู ุชู ุฅุตูุงุญูุง:

1. **ุนุฏู ุชุฃุซูุฑ ุนูููุงุช ุงูุดุฑุงุก ุนูู ุงูุจุทุงูุงุช ุงูุงุฆุชูุงููุฉ** โ
   - ุชู ุฅุถุงูุฉ logic ูุฎุตู ุงููุจูุบ ูู ุงูุฑุตูุฏ ุงููุชุงุญ ููุจุทุงูุฉ
   - ุชุณุฌูู ุงูุนูููุฉ ูู ุณุฌู ูุนุงููุงุช ุงูุจุทุงูุฉ

2. **ุฎูุงุฑุงุช ุทุฑู ุงูุฏูุน ูุญุฏูุฏุฉ** โ
   - ุชู ุฅุถุงูุฉ ุฎูุงุฑุงุช ุฌุฏูุฏุฉ ุดุงููุฉ

3. **ุนุฏู ุงูุชุญูู ูู ุงูุฃุฑุตุฏุฉ ุงููุงููุฉ** โ
   - ุชู ุฅุถุงูุฉ ุชุญูู ุดุงูู ูุจู ุฅุชูุงู ุงูุนูููุฉ

---

## ๐ ุทุฑู ุงูุฏูุน ุงููุฏุนููุฉ

### ุงูุฎูุงุฑุงุช ุงูุญุงููุฉ (ุงููุญุณููุฉ):

| ุงูุฎูุงุฑ | ุงูููุฏ | ุงูุญุงูุฉ | ุงูููุฒุงุช |
|--------|------|--------|--------|
| **ููุฏู** | `cash` | โ | ูุง ูุชุทูุจ ุชุญุฏูุซ ุฃุฑุตุฏุฉ |
| **ุจุทุงูุฉ ุงุฆุชูุงููุฉ** | `credit_card` | โ ูุญุณูู | ุฎุตู ูู ุงูุฑุตูุฏ ุงููุชุงุญ + ุชุณุฌูู ูุนุงููุฉ |
| **ุชุญููู ุจููู** | `bank_transfer` | โ | ูุง ูุชุทูุจ ุชุญุฏูุซ ุฃุฑุตุฏุฉ |
| **ูุญูุธุฉ ุฅููุชุฑูููุฉ** | `e_wallet` | โ ูุญุณูู | ุฎุตู ูู ุฑุตูุฏ ุงููุญูุธุฉ + ุชุญุฏูุซ ุงูุญุฏูุฏ |
| **ุจุทุงูุฉ ูุณุจูุฉ ุงูุฏูุน** | `prepaid_card` | โ ุฌุฏูุฏ | ุฎุตู ูู ุฑุตูุฏ ุงูุจุทุงูุฉ + ุชุณุฌูู ูุนุงููุฉ |
| **ูุงูููุฉ ุฏูุน** | `pos_machine` | โ ุฌุฏูุฏ | ุฅุถุงูุฉ ุงููุจูุบ ููุญุณุงุจ ุงูุฑุฆูุณู |
| **ุขุฌู** | `deferred` | โ | ูุชุทูุจ ุงุฎุชูุงุฑ ุนููู |

---

## ๐๏ธ ุงูุชุญุณููุงุช ุงูุชูููุฉ

### 1. ุฅุถุงูุฉ Contexts ุงูุฌุฏูุฏุฉ

```typescript
import { useCards } from '@/contexts/cards-context'
import { usePrepaidCards } from '@/contexts/prepaid-cards-context'
import { usePOSMachines } from '@/contexts/pos-machines-context'
import { useEWallets } from '@/contexts/e-wallets-context'
```

### 2. ุฅุถุงูุฉ State ุงูุฌุฏูุฏุฉ

```typescript
const [selectedCardId, setSelectedCardId] = useState<string>('')
const [selectedPrepaidCardId, setSelectedPrepaidCardId] = useState<string>('')
const [selectedPOSMachineId, setSelectedPOSMachineId] = useState<string>('')
const [selectedWalletId, setSelectedWalletId] = useState<string>('')
```

### 3. ุชุญุฏูุซ ููุน ุงูุจูุงูุงุช

```typescript
type PaymentMethod = 'cash' | 'credit_card' | 'bank_transfer' | 
                    'e_wallet' | 'prepaid_card' | 'pos_machine' | 'deferred'
```

---

## ๐ ุงูุชุญูู ูู ุงูุฃุฑุตุฏุฉ

### ูุจู ุฅุชูุงู ุงูุนูููุฉ:

```typescript
// ุงูุจุทุงูุงุช ุงูุงุฆุชูุงููุฉ
if (paymentMethod === 'credit_card') {
  const card = cards.find(c => c.id === selectedCardId)
  if (!card || card.availableCredit < total) {
    setError(`ุงูุฑุตูุฏ ุงููุชุงุญ ุบูุฑ ูุงูู. ุงูุฑุตูุฏ ุงููุชุงุญ: ${formatCurrency(card?.availableCredit || 0)}`)
    return
  }
}

// ุงูุจุทุงูุงุช ูุณุจูุฉ ุงูุฏูุน
if (paymentMethod === 'prepaid_card') {
  const prepaidCard = prepaidCards.find(c => c.id === selectedPrepaidCardId)
  if (!prepaidCard || prepaidCard.balance < total) {
    setError(`ุงูุฑุตูุฏ ุบูุฑ ูุงูู. ุงูุฑุตูุฏ ุงููุชุงุญ: ${formatCurrency(prepaidCard?.balance || 0)}`)
    return
  }
}

// ุงููุญุงูุธ ุงูุฅููุชุฑูููุฉ
if (paymentMethod === 'e_wallet') {
  const wallet = wallets.find(w => w.id === selectedWalletId)
  if (!wallet || wallet.balance < total) {
    setError(`ุงูุฑุตูุฏ ุบูุฑ ูุงูู. ุงูุฑุตูุฏ ุงููุชุงุญ: ${formatCurrency(wallet?.balance || 0)}`)
    return
  }
}
```

---

## ๐ณ ูุนุงูุฌุฉ ุงูุฏูุน

### ุจุนุฏ ุฅุชูุงู ุงูุนูููุฉ:

#### 1. ุงูุจุทุงูุงุช ุงูุงุฆุชูุงููุฉ
```typescript
if (paymentMethod === 'credit_card') {
  addCardPurchase({
    cardId: selectedCardId,
    amount: total,
    description: `ุดุฑุงุก ูู ุงููุจูุนุงุช - ูุงุชูุฑุฉ: ${saleId}`,
    date: new Date().toISOString(),
    merchant: 'ููุทุฉ ุงูุจูุน',
    category: 'ูุจูุนุงุช',
  })
}
```

#### 2. ุงูุจุทุงูุงุช ูุณุจูุฉ ุงูุฏูุน
```typescript
if (paymentMethod === 'prepaid_card') {
  addPrepaidPurchase(selectedPrepaidCardId, total, 'ููุทุฉ ุงูุจูุน', 'ูุจูุนุงุช', `ูุงุชูุฑุฉ: ${saleId}`)
}
```

#### 3. ุงููุญุงูุธ ุงูุฅููุชุฑูููุฉ
```typescript
if (paymentMethod === 'e_wallet') {
  updateWalletBalance(selectedWalletId, wallet.balance - total, -total)
}
```

#### 4. ูุงูููุงุช ุงูุฏูุน
```typescript
if (paymentMethod === 'pos_machine') {
  const machine = machines.find(m => m.id === selectedPOSMachineId)
  if (machine && machine.accounts.length > 0) {
    const primaryAccount = machine.accounts.find(a => a.isPrimary) || machine.accounts[0]
    updateAccountBalance(selectedPOSMachineId, primaryAccount.id, primaryAccount.balance + total)
  }
}
```

---

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุงูููุงุฆู ุงูููุณุฏูุฉ ุงูุฌุฏูุฏุฉ:

#### 1. ุงุฎุชูุงุฑ ุงูุจุทุงูุฉ ุงูุงุฆุชูุงููุฉ
```tsx
{paymentMethod === 'credit_card' && (
  <Select value={selectedCardId} onValueChange={setSelectedCardId}>
    <SelectTrigger>
      <SelectValue placeholder="ุงุฎุชุฑ ุจุทุงูุฉ" />
    </SelectTrigger>
    <SelectContent>
      {cards.map((card) => (
        <SelectItem key={card.id} value={card.id}>
          {card.cardName} - {formatCurrency(card.availableCredit)} ูุชุงุญ
        </SelectItem>
      ))}
    </SelectContent>
  </Select>
)}
```

#### 2. ุงุฎุชูุงุฑ ุงูุจุทุงูุฉ ูุณุจูุฉ ุงูุฏูุน
```tsx
{paymentMethod === 'prepaid_card' && (
  <Select value={selectedPrepaidCardId} onValueChange={setSelectedPrepaidCardId}>
    {/* ... */}
  </Select>
)}
```

#### 3. ุงุฎุชูุงุฑ ุงููุญูุธุฉ ุงูุฅููุชุฑูููุฉ
```tsx
{paymentMethod === 'e_wallet' && (
  <Select value={selectedWalletId} onValueChange={setSelectedWalletId}>
    {/* ... */}
  </Select>
)}
```

#### 4. ุงุฎุชูุงุฑ ูุงูููุฉ ุงูุฏูุน
```tsx
{paymentMethod === 'pos_machine' && (
  <Select value={selectedPOSMachineId} onValueChange={setSelectedPOSMachineId}>
    {/* ... */}
  </Select>
)}
```

---

## ๐ ุงูุณููุงุฑูููุงุช ุงููุฎุชุจุฑุฉ

### โ ุงูุณููุงุฑูู 1: ุงูุฏูุน ุจุงูุจุทุงูุฉ ุงูุงุฆุชูุงููุฉ
1. ุฅุถุงูุฉ ููุชุฌุงุช ููุณูุฉ
2. ุงุฎุชูุงุฑ "ุจุทุงูุฉ ุงุฆุชูุงููุฉ" ูู ุทุฑู ุงูุฏูุน
3. ุงุฎุชูุงุฑ ุงูุจุทุงูุฉ ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ
4. ุงูุชุญูู ูู ุงูุฑุตูุฏ ุงููุชุงุญ
5. ุฅุชูุงู ุงูุนูููุฉ
6. โ ุชุญุฏูุซ ุงูุฑุตูุฏ ุงููุชุงุญ ููุจุทุงูุฉ
7. โ ุชุณุฌูู ุงููุนุงููุฉ

### โ ุงูุณููุงุฑูู 2: ุงูุฏูุน ุจุจุทุงูุฉ ูุณุจูุฉ ุงูุฏูุน
1. ุฅุถุงูุฉ ููุชุฌุงุช ููุณูุฉ
2. ุงุฎุชูุงุฑ "ุจุทุงูุฉ ูุณุจูุฉ ุงูุฏูุน"
3. ุงุฎุชูุงุฑ ุงูุจุทุงูุฉ ูู ุงููุงุฆูุฉ
4. ุงูุชุญูู ูู ุงูุฑุตูุฏ
5. ุฅุชูุงู ุงูุนูููุฉ
6. โ ุฎุตู ุงููุจูุบ ูู ุฑุตูุฏ ุงูุจุทุงูุฉ
7. โ ุชุณุฌูู ุงููุนุงููุฉ

### โ ุงูุณููุงุฑูู 3: ุงูุฏูุน ุนุจุฑ ูุญูุธุฉ ุฅููุชุฑูููุฉ
1. ุฅุถุงูุฉ ููุชุฌุงุช ููุณูุฉ
2. ุงุฎุชูุงุฑ "ูุญูุธุฉ ุฅููุชุฑูููุฉ"
3. ุงุฎุชูุงุฑ ุงููุญูุธุฉ ูู ุงููุงุฆูุฉ
4. ุงูุชุญูู ูู ุงูุฑุตูุฏ
5. ุฅุชูุงู ุงูุนูููุฉ
6. โ ุฎุตู ุงููุจูุบ ูู ุฑุตูุฏ ุงููุญูุธุฉ
7. โ ุชุญุฏูุซ ุงูุญุฏูุฏ ุงููุณุชุฎุฏูุฉ

### โ ุงูุณููุงุฑูู 4: ุงูุฏูุน ุนุจุฑ ูุงูููุฉ ุฏูุน
1. ุฅุถุงูุฉ ููุชุฌุงุช ููุณูุฉ
2. ุงุฎุชูุงุฑ "ูุงูููุฉ ุฏูุน"
3. ุงุฎุชูุงุฑ ุงููุงูููุฉ ูู ุงููุงุฆูุฉ
4. ุฅุชูุงู ุงูุนูููุฉ
5. โ ุฅุถุงูุฉ ุงููุจูุบ ููุญุณุงุจ ุงูุฑุฆูุณู ุจุงููุงูููุฉ

### โ ุงูุณููุงุฑูู 5: ุฑุตูุฏ ุบูุฑ ูุงูู
1. ุฅุถุงูุฉ ููุชุฌุงุช ุจูููุฉ ุฃูุจุฑ ูู ุงูุฑุตูุฏ
2. ุงุฎุชูุงุฑ ุทุฑููุฉ ุฏูุน ุชุชุทูุจ ุฑุตูุฏ
3. ูุญุงููุฉ ุฅุชูุงู ุงูุนูููุฉ
4. โ ุนุฑุถ ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ ูุน ุงูุฑุตูุฏ ุงููุชุงุญ

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

| ุงูููู | ุงูุชุบููุฑุงุช |
|------|----------|
| `src/app/sales/page.tsx` | ุฅุถุงูุฉ contexts ุฌุฏูุฏุฉุ state ุฌุฏูุฏุฉุ logic ูุนุงูุฌุฉ ุงูุฏูุนุ ูุงุฌูุฉ ูุณุชุฎุฏู ูุญุณููุฉ |

---

## ๐ ุงูููุฒุงุช ุงูุฅุถุงููุฉ

- โ ุฅุนุงุฏุฉ ุชุนููู ุชููุงุฆูุฉ ููุญููู ุนูุฏ ุชุบููุฑ ุทุฑููุฉ ุงูุฏูุน
- โ ุนุฑุถ ุงูุฑุตูุฏ ุงููุชุงุญ ูู ุงูููุงุฆู ุงูููุณุฏูุฉ
- โ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ููููุฏุฉ
- โ ุฏุนู RTL ูุงูู
- โ ุฏุนู Dark Mode

---

## ๐ ุงูุฅุญุตุงุฆูุงุช

- **ุนุฏุฏ ุทุฑู ุงูุฏูุน ุงููุฏุนููุฉ:** 7
- **ุนุฏุฏ ุงูุชุญููุงุช ูู ุงูุฃุฑุตุฏุฉ:** 3
- **ุนุฏุฏ ุงูููุงุฆู ุงูููุณุฏูุฉ ุงูุฌุฏูุฏุฉ:** 4
- **ุนุฏุฏ ุงูุณููุงุฑูููุงุช ุงููุฎุชุจุฑุฉ:** 5

---

**ุชู ุงูุฅุตูุงุญ ูุงูุชุญุณูู ุจูุงุณุทุฉ:** Augment Agent  
**ุขุฎุฑ ุชุญุฏูุซ:** 2025-10-24

